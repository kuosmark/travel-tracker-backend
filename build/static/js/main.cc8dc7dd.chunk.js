(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{250:function(e,t,n){e.exports=n(452)},450:function(e,t,n){},452:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(38),s=n.n(o),c=n(15),i=n.n(c),l=n(17),u=n(217),m=n(89),p=n(90),d=n(94),f=n(91),h=n(96),g=n(99),v=n(30),w=n.n(v),k="http://localhost:3001/api/travels",E=null,b={getAll:function(){var e=Object(l.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.get(k);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(l.a)(i.a.mark(function e(t){var n,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:E}},e.next=3,w.a.post(k,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(l.a)(i.a.mark(function e(t,n){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.put("".concat(k,"/").concat(t),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(l.a)(i.a.mark(function e(t){var n,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:E}},e.next=3,w.a.delete("".concat(k,"/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){E="bearer ".concat(e)}},y=n(467),x=n(471),O=n(474),C=n(470),S=n(98),j=function(e){var t=e.title,n=e.remove;return r.a.createElement(x.a,{size:"huge"},r.a.createElement(x.a.Item,null,r.a.createElement(O.a,null,t)),r.a.createElement(x.a.Item,{position:"right"},r.a.createElement(C.a,{icon:!0,onClick:console.log("pencil")},r.a.createElement(S.a,{name:"pencil"}))),r.a.createElement(x.a.Item,{centered:!0},r.a.createElement(C.a,{icon:!0,onClick:n},r.a.createElement(S.a,{name:"trash"}))))},M=function(e){var t=e.open,n=e.close,a=e.inlineStyle,o=e.marker,s=e.remove;return console.log(o),r.a.createElement(y.a,{padded:!0,open:t,onClose:n,style:a.modal,closeIcon:!0},r.a.createElement(y.a.Header,null,r.a.createElement(j,{title:o.title,remove:s})),r.a.createElement(y.a.Content,null,o.text))},I={modal:{marginTop:"-200px",display:"fixed !important"}},P=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).componentDidMount=Object(l.a)(i.a.mark(function e(){var t,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.getAll();case 2:t=e.sent,console.log("data",t),a=t.map(function(e){return{id:e.id,title:e.title,text:e.text,position:{lat:e.position.lat,lng:e.position.lng}}}),n.setState({markers:a});case 6:case"end":return e.stop()}},e,this)})),n.updateMarker=Object(l.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)})),n.removeMarker=Object(l.a)(i.a.mark(function e(){var t,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.activeMarker,!window.confirm("Remove ".concat(t.title,"?"))){e.next=16;break}return e.prev=2,e.next=5,b.remove(t.id);case 5:return e.sent,a=n.state.markers.filter(function(e){return e.id!==t.id}),e.next=9,n.setState({markers:a});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0);case 14:return e.next=16,n.setState({activeMarker:{},modalOpen:!1});case 16:case"end":return e.stop()}},e,this,[[2,11]])})),n.onMarkerClick=function(){var e=Object(l.a)(i.a.mark(function e(t,a,r){var o,s,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.position.lat,s=t.position.lng,c=n.state.markers.find(function(e){return e.position.lat===o&&e.position.lng===s}),console.log("clicked",c),e.next=6,n.setState({selectedPlace:t,activeMarker:c,modalOpen:!0});case 6:case"end":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}(),n.onClose=function(e){n.state.showingInfoWindow&&n.setState({showingInfoWindow:!1,activeMarker:{},modalOpen:!1})},n.createMarker=Object(l.a)(i.a.mark(function e(){var t,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.newMarker,console.log("t\xe4s ny",t),e.prev=2,e.next=5,b.create(t);case 5:return a=e.sent,e.next=8,n.setState({markers:n.state.markers.concat(a),activeMarker:a,modalOpen:!0});case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:case"end":return e.stop()}},e,this,[[2,10]])})),n.onMapClicked=function(e,t,a){var r=a.latLng,o={title:"moi",text:"add text...",position:{lat:r.lat(),lng:r.lng()}};n.setState({newMarker:o}),console.log("t\xe4s",o),n.createMarker()},n.renderMarkers=function(){var e=n.state.markers;return console.log("markers",e),e.map(function(e){return r.a.createElement(g.Marker,{key:e.id,title:e.title,name:e.text,position:e.position,onClick:n.onMarkerClick})})},n.handleOpen=function(){return n.setState({modalOpen:!0})},n.handleClose=function(){return n.setState({modalOpen:!1})},n.state={user:n.props.user,showingInfoWindow:!1,activeMarker:{},selectedPlace:{},modalOpen:!1,newMarker:{},markers:[]},n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return console.log(this.state.markers),console.log(this.state.activeMarker),r.a.createElement("div",{style:{height:350,width:"100%",display:"flex",flexFlow:"row nowrap",justifyContent:"center",padding:0}},r.a.createElement(M,{open:this.state.modalOpen,close:this.handleClose,inlineStyle:I,marker:this.state.activeMarker,remove:this.removeMarker}),r.a.createElement(g.Map,{google:this.props.google,zoom:2,initialCenter:{lat:0,lng:0},onClick:this.onMapClicked},this.renderMarkers()))}}]),t}(a.Component),A=Object(g.GoogleApiWrapper)(function(e){return{apiKey:e.apiKey,language:e.language}})(P),U=n(465),z=n(472),T=n(477),W=n(461),L=n(462),G=(n(463),r.a.createElement(W.a,null),n(475)),D=n(464),F=(n(468),n(466)),J=n(476),N=n(469),K=function(e){var t=e.onSubmit,n=e.handleChange,a=e.username,o=e.password;return r.a.createElement("div",{className:"login-form"},r.a.createElement("style",null,"\n      body > div,\n      body > div > div,\n      body > div > div > div.login-form {\n        height: 100%;\n      }\n    "),r.a.createElement(G.a,{textAlign:"center",style:{height:"100%"},verticalAlign:"middle"},r.a.createElement(G.a.Column,{style:{maxWidth:450}},r.a.createElement(O.a,{as:"h2",color:"blue",textAlign:"center"},r.a.createElement(S.a,{name:"plane"})," Log in to account"),r.a.createElement(F.a,{onSubmit:t,size:"large"},r.a.createElement(J.a,null,r.a.createElement(F.a.Input,{fluid:!0,icon:"user",name:"username",iconPosition:"left",placeholder:"Username",value:a,onChange:n}),r.a.createElement(F.a.Input,{fluid:!0,icon:"lock",name:"password",iconPosition:"left",placeholder:"Password",type:"password",value:o,onChange:n}),r.a.createElement(C.a,{color:"blue",fluid:!0,size:"large",type:"submit"},"Login"))),r.a.createElement(N.a,null,r.a.createElement(L.a,{to:"/create"},"Create new account")))))},R=function(e){var t=e.onSubmit,n=e.handleChange,a=e.username,o=e.password,s=e.password2;return r.a.createElement("div",{className:"login-form"},r.a.createElement("style",null,"\n      body > div,\n      body > div > div,\n      body > div > div > div.login-form {\n        height: 100%;\n      }\n    "),r.a.createElement(G.a,{textAlign:"center",style:{height:"100%"},verticalAlign:"middle"},r.a.createElement(G.a.Column,{style:{maxWidth:450}},r.a.createElement(O.a,{as:"h2",color:"blue",textAlign:"center"},r.a.createElement(S.a,{name:"user circle"})," Create new account"),r.a.createElement(F.a,{onSubmit:t,size:"large"},r.a.createElement(J.a,null,r.a.createElement(F.a.Input,{fluid:!0,icon:"user",name:"newUsername",iconPosition:"left",placeholder:"Username",value:a,onChange:n}),r.a.createElement(F.a.Input,{fluid:!0,icon:"lock",name:"newPassword",iconPosition:"left",placeholder:"Password",type:"password",value:o,onChange:n}),r.a.createElement(F.a.Input,{fluid:!0,icon:"lock",name:"newPassword2",iconPosition:"left",placeholder:"Repeat password",type:"password",value:s,onChange:n}),r.a.createElement(C.a,{color:"blue",fluid:!0,size:"large",type:"submit"},"Submit"))),r.a.createElement(N.a,null,r.a.createElement(L.a,{to:"/login"},"Login to account")))))},H={login:function(){var e=Object(l.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.post("http://localhost:3001/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},q="http://localhost:3001/api/users",B={getAll:function(){var e=Object(l.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.get(q);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(l.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=w.a.post(q,t),e.abrupt("return",n.data);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(l.a)(i.a.mark(function e(t,n){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.put("".concat(q,"/").concat(t),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(l.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.delete("".concat(q,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},Q=function(e){var t=e.message,n=e.color,a="red"===n?"warning sign":"thumbs up",o="red"===n?"Warning!":"Success!";return t?r.a.createElement("div",null,r.a.createElement(D.a,{hidden:!0}),r.a.createElement(N.a,{icon:a,size:"big",color:n,header:o,content:t,warning:!0})):null},V=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(d.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={user:null,username:"",newUsername:"",newPassword:"",newPassword2:"",password:"",color:"",message:""},n.handleFieldChange=function(e){console.log(e.target.value),n.setState(Object(u.a)({},e.target.name,e.target.value))},n.componentDidMount=Object(l.a)(i.a.mark(function e(){var t,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(t=window.localStorage.getItem("loggedInUser"))&&(a=JSON.parse(t),n.setState({user:a}),b.setToken(a.token));case 2:case"end":return e.stop()}},e,this)})),n.logout=function(){b.setToken(null),window.localStorage.removeItem("loggedInUser"),n.notify("".concat(n.state.user.username," logged out succesfully!"),"green"),n.setState({user:null}),console.log("hoidettu")},n.notify=function(e,t){n.setState({message:e,color:t}),setTimeout(function(){n.setState({message:null,color:null})},2e3)},n.login=function(){var e=Object(l.a)(i.a.mark(function e(t){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,H.login({username:n.state.username,password:n.state.password});case 4:a=e.sent,window.localStorage.setItem("loggedInUser",JSON.stringify(a)),b.setToken(a.token),n.setState({username:"",password:"",user:a}),n.notify("".concat(n.state.user.username," logged in succesfully!"),"green"),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0),n.notify("invalid username or password, try again!","red"),n.setState({username:"",password:""});case 16:case"end":return e.stop()}},e,this,[[1,11]])}));return function(t){return e.apply(this,arguments)}}(),n.register=function(){var e=Object(l.a)(i.a.mark(function e(t){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),(a=n.state.newPassword)!==n.state.newPassword2?n.notify("Passwords don't match!","red"):a.length<3?n.notify("Password must be at least 3 characters long!","red"):n.createAccount();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.createAccount=Object(l.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B.create({username:n.state.newUsername,password:n.state.newPassword});case 3:e.sent,n.notify("account ".concat(n.state.newUsername," created!"),"green"),n.setState({newUsername:"",newPassword:"",newPassword2:""}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),n.notify("server error!","red");case 12:n.props.history.push("/login");case 13:case"end":return e.stop()}},e,this,[[0,8]])})),n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;console.log("THE USER IS",this.state.user);var t=null!==this.state.user;return r.a.createElement(W.a,null,r.a.createElement(Q,{message:this.state.message,color:this.state.color}),r.a.createElement(U.a,{exact:!0,path:"/",render:t?function(){return r.a.createElement(z.a,{to:"/map"})}:function(){return r.a.createElement(z.a,{to:"/login"})}}),r.a.createElement(U.a,{path:"/login",render:t?function(){return r.a.createElement(z.a,{to:"/map"})}:function(){return r.a.createElement(K,{onSubmit:e.login,handleChange:e.handleFieldChange,username:e.state.username,password:e.state.password})}}),r.a.createElement(U.a,{path:"/create",render:t?function(){return r.a.createElement(z.a,{to:"/map"})}:function(){return r.a.createElement(R,{onSubmit:e.register.bind(e),handleChange:e.handleFieldChange,username:e.state.newUsername,password:e.state.newPassword,password2:e.state.newPassword2})}}),r.a.createElement(U.a,{path:"/map",render:t?function(){return r.a.createElement(X,{user:e.state.user,logout:e.logout,settings:e.logout})}:function(){return r.a.createElement(z.a,{to:"/"})}}))}}]),t}(a.Component),X=function(e){var t=e.user,n=e.logout,a=e.settings;return r.a.createElement("div",{style:{width:"100%",marginLeft:0}},r.a.createElement(Y,{name:t.username,logout:n,settings:a}),r.a.createElement(A,{user:t,apiKey:"AIzaSyCy6G0q6EnGtGPGAAvLlC37STQU4Med0xE",language:"en"}))},Y=function(e){var t=e.name,n=e.logout,a=e.settings;return r.a.createElement(x.a,{stackable:!0,widths:4,size:"huge"},r.a.createElement(x.a.Item,null,"Welcome ",t,"!"),r.a.createElement(x.a.Item,null,r.a.createElement(C.a,{onClick:a},"Settings")),r.a.createElement(x.a.Item,null,r.a.createElement(C.a,{onClick:n},"Log out")))},Z=Object(T.a)(V),$=n(473);n(450);s.a.render(r.a.createElement($.a,null,r.a.createElement(Z,null)),document.getElementById("root"))}},[[250,2,1]]]);
//# sourceMappingURL=main.cc8dc7dd.chunk.js.map