(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{250:function(e,t,n){e.exports=n(451)},449:function(e,t,n){},451:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(37),o=n.n(s),c=n(15),i=n.n(c),l=n(17),u=n(58),m=n(95),d=n(96),p=n(212),h=n(97),f=n(214),g=n(217),w=n(104),v=n(22),E=n.n(v),b="http://localhost:3001/api/travels",k=null,x={getAll:function(){var e=Object(l.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get(b);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(l.a)(i.a.mark(function e(t){var n,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},e.next=3,E.a.post(b,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(l.a)(i.a.mark(function e(t,n){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.put("".concat(b,"/").concat(t),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(l.a)(i.a.mark(function e(t){var n,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},e.next=3,E.a.delete("".concat(b,"/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){k="bearer ".concat(e)}},y=n(460),O=n(467),C=n(470),S=n(216),j=n(462),M=n(473),I=n(474),T=n(466),A=n(469),P=function(e){var t=e.open,n=e.close,a=e.inlineStyle,s=e.marker,o=e.newTitle,c=e.newText,i=e.onRemoveSubmit,l=e.onEditSubmit,u=e.handleChange,m=e.active,d=e.setInfo,p=e.setEdit,h=e.setSettings,f=e.confirmOpen,g=e.openConfirm,w=e.closeConfirm;return r.a.createElement("div",null,r.a.createElement(y.a,{centered:!1,header:"WARNING!",textAlign:"top",content:0===c.length&&0===o.length?"Do you want to remove the empty marker?":"Are you sure?",cancelButton:"Never mind",confirmButton:"Let's do it",open:f,onCancel:w,onConfirm:i}),r.a.createElement(O.a,{padded:!0,open:t,onClose:n,style:a.modal,closeIcon:!0},r.a.createElement("div",null,r.a.createElement(C.a,{icon:"labeled",fluid:!0,widths:3,tabular:!0,size:"huge",color:"blue"},r.a.createElement(C.a.Item,{name:"info",active:"info"===m,onClick:d},r.a.createElement(S.a,{name:"book"}),"Info"),r.a.createElement(C.a.Item,{name:"edit",active:"edit"===m,onClick:p},r.a.createElement(S.a,{name:"edit"}),"Edit"),r.a.createElement(C.a.Item,{name:"settings",active:"settings"===m,onClick:h},r.a.createElement(S.a,{name:"trash"}),"Remove")),r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0}),"info"===m?r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(M.a,{centered:!0,verticalAlign:"middle"},r.a.createElement(M.a.Row,null,r.a.createElement(I.a,{as:"h1",textAlign:"center"},r.a.createElement(j.a,{hidden:!0}),o.length>0?s.title:"")),r.a.createElement(M.a.Row,null,r.a.createElement(I.a,{as:"h3"},s.text))))):"edit"===m?r.a.createElement("div",null,r.a.createElement(M.a,{centered:!0,verticalAlign:"middle"},r.a.createElement(M.a.Column,{style:{maxWidth:450}},r.a.createElement(T.a,{onSubmit:l,size:"large"},r.a.createElement(T.a.Input,{name:"newTitle",label:"Edit title",value:o,onChange:u}),r.a.createElement(T.a.TextArea,{name:"newText",label:"Additional information",value:c,rows:4,onChange:u}),r.a.createElement(A.a,{color:"blue",fluid:!0,size:"large",type:"submit"},"Update"))))):r.a.createElement("div",null,r.a.createElement(j.a,{hidden:!0}),r.a.createElement(M.a,{padded:"very",centered:!0,verticalAlign:"middle"},r.a.createElement(A.a,{size:"large",centered:"top",color:"blue",type:"submit",onClick:g},"Remove marker")),r.a.createElement(j.a,{hidden:!0})),r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0}))))},z={modal:{marginTop:"-250px",display:"fixed !important"}},U=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(p.a)(this,Object(h.a)(t).call(this,e))).componentDidMount=Object(l.a)(i.a.mark(function e(){var t,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.getAll();case 2:t=e.sent,a=t.map(function(e){return{user:e.user._id,id:e.id,title:e.title,text:e.text,position:{lat:e.position.lat,lng:e.position.lng}}}),n.setState({markers:a});case 5:case"end":return e.stop()}},e,this)})),n.open=function(){return n.setState({open:!0})},n.close=function(){return n.setState({open:!1})},n.handleFieldChange=function(e){n.setState(Object(u.a)({},e.target.name,e.target.value))},n.updateMarker=function(){var e=Object(l.a)(i.a.mark(function e(t){var a,r,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(g.a)({},n.state.activeMarker,{title:n.state.newTitle,text:n.state.newText}),e.next=3,x.update(a.id,a);case 3:return r=e.sent,s=n.state.markers.filter(function(e){return e.id!==a.id}),e.next=7,n.setState({activeMarker:r,newTitle:r.title,newText:r.text,markers:s.concat(r),activeMenuItem:"info"});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.removeMarker=Object(l.a)(i.a.mark(function e(){var t,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.activeMarker,e.prev=1,e.next=4,x.remove(t.id);case 4:return a=n.state.markers.filter(function(e){return e.id!==t.id}),e.next=7,n.setState({markers:a});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:return e.next=14,n.setState({activeMarker:{},newTitle:"",newText:"",modalOpen:!1,open:!1});case 14:case"end":return e.stop()}},e,this,[[1,9]])})),n.onMarkerClick=function(){var e=Object(l.a)(i.a.mark(function e(t,a,r){var s,o,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s=t.position.lat,o=t.position.lng,c=n.state.markers.find(function(e){return e.position.lat===s&&e.position.lng===o}),n.setState({selectedPlace:t,activeMarker:c,newTitle:c.title,newText:c.text,modalOpen:!0,activeMenuItem:"info"});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}(),n.handleModalClose=function(e){0===n.state.newText.length&&0===n.state.newTitle.length?n.open():n.setState({activeMarker:{},newTitle:"",newText:"",modalOpen:!1})},n.onMapClicked=function(){var e=Object(l.a)(i.a.mark(function e(t,a,r){var s,o,c,l,u;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.latLng,o=s.lat(),c=s.lng(),l={user:n.state.user.id,title:"",text:"",position:{lat:o,lng:c}},e.prev=4,e.next=7,x.create(l);case 7:return u=e.sent,e.next=10,n.setState({markers:n.state.markers.concat(u),activeMarker:u,newTitle:u.title,newText:u.text,modalOpen:!0,activeMenuItem:"edit"});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),console.log(e.t0);case 15:case"end":return e.stop()}},e,this,[[4,12]])}));return function(t,n,a){return e.apply(this,arguments)}}(),n.renderMarkers=function(){return n.state.markers.filter(function(e){return e.user===n.state.user.id}).map(function(e){return r.a.createElement(w.Marker,{key:e.id,title:e.title,name:e.text,position:e.position,onClick:n.onMarkerClick})})},n.handleClose=function(){return n.setState({modalOpen:!1})},n.setInfo=function(){return n.setState({activeMenuItem:"info"})},n.setEdit=function(){return n.setState({activeMenuItem:"edit"})},n.setSettings=function(){return n.setState({activeMenuItem:"settings"})},n.state={user:n.props.user,activeMarker:{},modalOpen:!1,markers:[],newTitle:"",newText:"",activeMenuItem:"info",open:!1},n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{height:"100%",width:"100%",display:"flex",flexFlow:"row nowrap",justifyContent:"center",padding:0}},r.a.createElement(P,{open:this.state.modalOpen,close:this.handleModalClose,inlineStyle:z,marker:this.state.activeMarker,newTitle:this.state.newTitle,newText:this.state.newText,onRemoveSubmit:this.removeMarker,onEditSubmit:this.updateMarker,handleChange:this.handleFieldChange,active:this.state.activeMenuItem,setInfo:this.setInfo,setEdit:this.setEdit,setSettings:this.setSettings,confirmOpen:this.state.open,openConfirm:this.open,closeConfirm:this.close}),r.a.createElement(w.Map,{google:this.props.google,zoom:2,initialCenter:{lat:0,lng:0},onClick:this.onMapClicked},this.renderMarkers()))}}]),t}(a.Component),R=Object(w.GoogleApiWrapper)(function(e){return{apiKey:e.apiKey,language:e.language}})(U),L=n(465),N=n(471),F=n(476),G=n(464),W=n(475),D=n(468),J=n(463),B=function(e){var t=e.message,n=e.color,a="red"===n?"warning sign":"thumbs up",s="red"===n?"Warning!":"Success!";return t?r.a.createElement("div",null,r.a.createElement(j.a,{hidden:!0}),r.a.createElement(D.a,{icon:a,size:"large",color:n,header:s,content:t,warning:!0})):null},K=function(e){var t=e.onSubmit,n=e.handleChange,a=e.username,s=e.password,o=e.message,c=e.color;return r.a.createElement("div",{className:"login-form",style:{overflow:"hidden"}},r.a.createElement(B,{message:o,color:c}),r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0}),o?r.a.createElement("div",null):r.a.createElement("div",null,r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0})),r.a.createElement(M.a,{textAlign:"center",style:{height:"100%"},verticalAlign:"middle"},r.a.createElement(M.a.Column,{style:{maxWidth:450}},r.a.createElement(I.a,{as:"h2",color:"blue",textAlign:"center"},r.a.createElement(S.a,{name:"plane"})," Log in to account"),r.a.createElement(T.a,{onSubmit:t,size:"large"},r.a.createElement(W.a,null,r.a.createElement(T.a.Input,{fluid:!0,icon:"user",name:"username",iconPosition:"left",placeholder:"Username",value:a,onChange:n}),r.a.createElement(T.a.Input,{fluid:!0,icon:"lock",name:"password",iconPosition:"left",placeholder:"Password",type:"password",value:s,onChange:n}),r.a.createElement(A.a,{color:"blue",fluid:!0,size:"large",type:"submit"},"Login"))),r.a.createElement(D.a,null,r.a.createElement(J.a,{to:"/create"},"Create new account")))),r.a.createElement(j.a,{hidden:!0}))},q=function(e){var t=e.onSubmit,n=e.handleChange,a=e.username,s=e.password,o=e.password2,c=e.message,i=e.color;return r.a.createElement("div",{className:"login-form",style:{overflow:"hidden"}},r.a.createElement(B,{message:c,color:i}),r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0}),c?r.a.createElement("div",null):r.a.createElement("div",null,r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0}),r.a.createElement(j.a,{hidden:!0})),r.a.createElement(M.a,{textAlign:"center",style:{height:"100%"},verticalAlign:"middle"},r.a.createElement(M.a.Column,{style:{maxWidth:450}},r.a.createElement(I.a,{as:"h2",color:"blue",textAlign:"center"},r.a.createElement(S.a,{name:"user circle"})," Create new account"),r.a.createElement(T.a,{onSubmit:t,size:"large"},r.a.createElement(W.a,null,r.a.createElement(T.a.Input,{fluid:!0,icon:"user",name:"newUsername",iconPosition:"left",placeholder:"Username",value:a,onChange:n}),r.a.createElement(T.a.Input,{fluid:!0,icon:"lock",name:"newPassword",iconPosition:"left",placeholder:"Password",type:"password",value:s,onChange:n}),r.a.createElement(T.a.Input,{fluid:!0,icon:"lock",name:"newPassword2",iconPosition:"left",placeholder:"Repeat password",type:"password",value:o,onChange:n}),r.a.createElement(A.a,{color:"blue",fluid:!0,size:"large",type:"submit"},"Submit"))),r.a.createElement(D.a,null,r.a.createElement(J.a,{to:"/login"},"Login to account")))),r.a.createElement(j.a,{hidden:!0}))},Q={login:function(){var e=Object(l.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("http://localhost:3001/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},_="http://localhost:3001/api/users",H={getAll:function(){var e=Object(l.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get(_);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(l.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=E.a.post(_,t),e.abrupt("return",n.data);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(l.a)(i.a.mark(function e(t,n){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.put("".concat(_,"/").concat(t),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(l.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.delete("".concat(_,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},V=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={user:null,username:"",newUsername:"",newPassword:"",newPassword2:"",password:"",color:"",message:"",settingsOpen:!1,menu:!0},n.handleFieldChange=function(e){n.setState(Object(u.a)({},e.target.name,e.target.value))},n.componentDidMount=Object(l.a)(i.a.mark(function e(){var t,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(t=window.localStorage.getItem("loggedInUser"))&&(a=JSON.parse(t),n.setState({user:a}),x.setToken(a.token));case 2:case"end":return e.stop()}},e,this)})),n.logout=function(){x.setToken(null),window.localStorage.removeItem("loggedInUser"),n.notify("".concat(n.state.user.username," logged out succesfully!"),"green"),n.setState({user:null})},n.notify=function(e,t){n.setState({message:e,color:t}),setTimeout(function(){n.setState({message:null,color:null})},2e3)},n.login=function(){var e=Object(l.a)(i.a.mark(function e(t){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,Q.login({username:n.state.username,password:n.state.password});case 4:a=e.sent,window.localStorage.setItem("loggedInUser",JSON.stringify(a)),x.setToken(a.token),n.setState({username:"",password:"",user:a}),n.notify("".concat(n.state.user.username," logged in succesfully!"),"green"),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0),n.notify("invalid username or password, try again!","red"),n.setState({username:"",password:""});case 16:case"end":return e.stop()}},e,this,[[1,11]])}));return function(t){return e.apply(this,arguments)}}(),n.register=function(){var e=Object(l.a)(i.a.mark(function e(t){var a,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a=n.state.newUsername,r=n.state.newPassword,a.length<3?n.notify("Username must be at least 3 characters long","red"):r!==n.state.newPassword2?n.notify("Passwords don't match!","red"):r.length<3?n.notify("Password must be at least 3 characters long!","red"):n.createAccount();case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.createAccount=Object(l.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,H.create({username:n.state.newUsername,password:n.state.newPassword});case 3:n.notify("account ".concat(n.state.newUsername," created!"),"green"),n.setState({newUsername:"",newPassword:"",newPassword2:""}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),n.notify("server error!","red");case 11:n.props.history.push("/login");case 12:case"end":return e.stop()}},e,this,[[0,7]])})),n.settings=function(){n.setState({settingsOpen:!0})},n.settingsOnClose=function(){n.setState({settingsOpen:!1})},n.menuOff=function(){n.setState({menu:!1})},n.menuOn=function(){n.setState({menu:!0})},n.changePassword=function(){},n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=null!==this.state.user;return r.a.createElement(G.a,{style:{height:"100%"}},r.a.createElement(L.a,{exact:!0,path:"/",render:t?function(){return r.a.createElement(N.a,{to:"/map"})}:function(){return r.a.createElement(N.a,{to:"/login"})}}),r.a.createElement(L.a,{style:{height:"100%"},path:"/login",render:t?function(){return r.a.createElement(N.a,{to:"/map"})}:function(){return r.a.createElement(K,{onSubmit:e.login,handleChange:e.handleFieldChange,username:e.state.username,password:e.state.password,message:e.state.message,color:e.state.color})}}),r.a.createElement(L.a,{style:{height:"100%"},path:"/create",render:t?function(){return r.a.createElement(N.a,{to:"/map"})}:function(){return r.a.createElement(q,{onSubmit:e.register,handleChange:e.handleFieldChange,username:e.state.newUsername,password:e.state.newPassword,password2:e.state.newPassword2,message:e.state.message,color:e.state.color})}}),r.a.createElement(L.a,{path:"/map",render:t?function(){return r.a.createElement(X,{user:e.state.user,logout:e.logout,settings:e.settings,settingsOpen:e.state.settingsOpen,settingsOnClose:e.settingsOnClose,menu:e.state.menu,menuOff:e.menuOff,menuOn:e.menuOn,changePassword:e.changePassword})}:function(){return r.a.createElement(N.a,{to:"/"})}}))}}]),t}(a.Component),X=function(e){var t=e.user,n=e.logout;e.settings;return r.a.createElement("div",null,r.a.createElement(R,{user:t,apiKey:"AIzaSyCy6G0q6EnGtGPGAAvLlC37STQU4Med0xE",language:"en"}),r.a.createElement(Y,{logout:n}))},Y=function(e){var t=e.logout;return r.a.createElement("div",null,r.a.createElement(C.a,{fluid:!0,widths:3,borderless:!0,size:"huge"},r.a.createElement(C.a.Item,null,r.a.createElement(A.a,{color:"blue",onClick:t,size:"large"},r.a.createElement(S.a,{name:"log out"}),"Log out"))))},Z=Object(F.a)(V),$=n(472);n(449);o.a.render(r.a.createElement($.a,null,r.a.createElement(Z,null)),document.getElementById("root"))}},[[250,2,1]]]);
//# sourceMappingURL=main.812e37f2.chunk.js.map